(()=>{"use strict";const e=window.location.hostname.split("."),n=e.filter((e=>!["oops","12days"].includes(e))).join("."),t='<img src="img/emojis/1F92D.png" alt="" />',o='<img src="img/cmdchallenge-round.png" alt="" />',a='<img src="img/emojis/1F384.png" alt="" />',r="//"+n,s="//oops."+n,c="//12days."+n,i="cmdchallenge",l="oops",g="12days",u=["oops","12days"].includes(e[0])?e[0]:"cmdchallenge",m={CMD:'<a href="//'+r+'">'+o+"</a>",OOPS:'<a href="//'+s+'">'+t+"</a>",XMAS:'<a href="//'+c+'">'+a+"</a>"},d=window.location.hostname.match(/local/)?"https://testing.cmdchallenge.com/r":"/r",p=u===l?["echo","read"]:["find","echo","awk","sed","perl","wc","grep","cat","sort","cut","ls","tac","jq","paste","tr","rm","tail","comm","egrep"],h="correct_answers",f="incorrect",F="correct",b="error";jQuery((function(e){let n,s,c=null,j=[];const w=function*(e){for(;;)yield*e},v=w(["emojis/1F63F.png"]),y=w(["emojis/E282.png","emojis/1F645-200D-2640-FE0F.png","emojis/1F645-200D-2642-FE0F.png","emojis/1F940.png"]),k=w(["emojis/1F471-200D-2640-FE0F.png","emojis/1F471-200D-2642-FE0F.png"]),x=w(["emojis/1F9D4.png","emojis/1F468-200D-1F9B1.png","emojis/1F468-200D-1F9B0.png","emojis/1F468-200D-1F33E.png","emojis/1F468-200D-1F52C.png","emojis/1F468-200D-1F373.png","emojis/1F468-200D-1F393.png"]),C=w(["emojis/1F478.png","emojis/1F482.png","emojis/1F9DD.png","emojis/1F9DD-200D-2640-FE0F.png","emojis/1F680.png"]),D=w(["emojis/1F600.png","emojis/1F604.png","emojis/1F970.png","emojis/1F60D.png","emojis/1F929.png"]),_=w(["emojis/1F936.png","emojis/1F385.png","emojis/1F36D.png","emojis/2603.png"]),E=new commonmark.Parser,O=new commonmark.HtmlRenderer,S=function(e){const n=E.parse(e);return O.render(n)},T=function(){c&&!less&&(s=M("0","green"))},N=function(e){let n;try{n=JSON.parse(localStorage.getItem(e))}catch(e){n=[]}return null===n&&(n=[]),n.filter(((e,n,t)=>t.indexOf(e)===n))},I=function(){if(0===L().length){switch(u){case l:e(".title .won").html('üéâ Congrats, you completed the challenge! üéâ Try <a href="'+r+'">even more challenges!</a>').show();break;case i:e(".title .won").html("üéâ Congrats, you completed the challenge! üéâ").show()}return!0}return e(".title .won").hide(),!1},M=function(e,n,t){return t||(t=""),"[["+t+";"+n+";black]"+e+"]"},P=function(t){e("div#badges").html(""),U().concat(L()[0]||[]).forEach((function(t){const o=t.slug,a=t.disp_title;e("div#badges").append("<div tabindex='-1' class='img-container "+o+"'><a title='"+a+"' id='badge_"+o+"' href='#/"+o+"'><img class='badge' src='img/"+t.emoji+".png' alt='"+o+"'/></a></li>"),e("a#badge_"+o).on("click",(function(e){e.preventDefault(),e.stopPropagation(),n.focus(),routie("/"+o)}))})),J(),function(){const n=c.slug;j.forEach((function(t){n==t.slug?(e("#"+t.slug).removeClass("active-challenge inactive-challenge").addClass("active-challenge"),e(".img-container."+t.slug).removeClass("active-badge inactive-badge").addClass("active-badge")):(e("#"+t.slug).removeClass("active-challenge inactive-challenge").addClass("inactive-challenge"),e(".img-container."+t.slug).removeClass("active-badge inactive-badge").addClass("inactive-badge"))}))}(),e("#learn").html(""),c.learn&&q(),"function"==typeof t&&t()},B=function(n,t){switch(e("#info-box .text").html(n),t){case F:const n=j.indexOf(c);let o;switch(u){case l:o=D.next().value;break;case i:o=n<4?k.next().value:n>=4&&n<20?x.next().value:C.next().value;break;case g:o=_.next().value}e("#info-box .gradient").removeClass("incorrect correct error").addClass("correct"),e("#info-box .img").html("<img src='img/"+o+"' alt='correct' />");break;case f:e("#info-box .gradient").removeClass("incorrect correct error").addClass("incorrect"),e("#info-box .img").html("<img src='img/"+y.next().value+"' alt='incorrect' />");break;case b:e("#info-box .gradient").removeClass("incorrect correct error").addClass("error"),e("#info-box .img").html("<img src='img/"+v.next().value+"' alt='correct' />");break;default:throw new Error("Invalid status: "+t)}e("#info-box").show()},A=function(){const n=S(c.description);e("#challenge-desc .img-container").html("<img src='img/"+c.emoji+".png' alt='"+c.disp_title+"' />"),e("#challenge-desc .desc-container").html(n)},L=function(){const e=N(h);return j.filter((n=>!e.includes(n.slug)))},U=function(){const e=N(h);return j.filter((n=>e.includes(n.slug)))},q=function(){c.disp_learn?e("#chck2").prop("checked",!0):e("#chck2").prop("checked",!1),e("#learn").html(S(c.learn)),e("#learn-box").show()},J=function(){e.ajax({dataType:"json",url:"/s/solutions/"+c.slug+".json",success:function(n){e("#solutions").html("").show(),n.cmds.forEach((function(n){e("#solutions").append(R(n)+"\n")})),hljs.highlightBlock(document.getElementById("solutions")),e("#solutions-wrapper .last-updated").html("Solutions updated "+Y(n.ts)+" ago")},error:function(){e("#solutions").html("").hide(),e("#solutions-wrapper .last-updated").html("No solutions for this challenge yet")}})},R=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/\n/g,"\n  ")},Y=function(e){const n=(new Date).getTime()/1e3,t=Math.round(n-e),o=Math.floor(t/60),a=t%60;let r="";return o&&(r+=1===o?o+" minute ":o+" minutes "),r+=1===a?" and "+a+" second":" and "+a+" seconds",r},G=function(t){s=0===t.return_code?M(t.return_code,"green"):M(t.return_code,"red"),isNaN(t.return_code)?B("Unable to process command - got response: "+t.output,b):(function(n){const t=n.split("\n");e("#challenge-output").text(""),t.forEach((function(n){e("#challenge-output").append("<span>"+n+"</span>")})),e("#challenge-output").show()}(t.output),t.correct?function(e,n,t){let o;const a=N(n);a.includes(e)||(o=JSON.stringify(a.concat([e])),localStorage.setItem(n,o)),t()}(t.challenge_slug,h,(function(){P(),c=L()[0]||j[0],I()?B("Correct! You you completed all of the challenges, but feel free to keep on going!",F):B("Correct! You have a new challenge!",F),routie("/"+c.slug)})):(B("Incorrect answer, try again",f),t.test_errors&&t.test_errors.length>0?B(t.test_errors[0]+" - try again",f):t.rand_error&&B("Test against random data failed - try again",f))),n.resume()};switch(u){case l:e("#header-img").html(t),e("#header-text").html("Oops I deleted my bin/ dir :("),e("#links ul").prepend('<li class="link">'+m.CMD+"</li>");break;case g:WebFont.load({custom:{families:["Snowburst One","Princess Sofia"],urls:["../css/fonts.css"]},active:function(){e("#header-img").html(a),e("#header-text").addClass("snowburst"),e("#header-text").html("12 Days of Shell"),e("#links ul").prepend(m.OOPS),e("#links ul").prepend(m.CMD)}});break;case i:console.log("cmd!"),e("#header-text").html("Command Challenge"),e("#header-img").html(o),e("#links ul").prepend(m.OOPS)}var H;e("#header-img").show(),e("#header-text").show(),s=M("0","green"),e(document).keydown((function(n){const t=n.target.nodeName.toLowerCase();if(("input"!=t&&"textarea"!=t||e(n.target).attr("readonly")||"checkbox"===n.target.getAttribute("type"))&&8===n.keyCode)return!1})),H=function(t){j=t,e("#term-challenge").terminal((function(n,t){""!==(n=n.replace(/^\s+|\s+$/g,""))?(routie("/"+c.slug),e("#info-box").hide(),e("#challenge-output").text("").hide(),e("#chck1").prop("checked",!1),/tail\s+-[Ff]/.test(n)?B("<code>tail -f</code> will wait for additional data to be appended to the file, try removing the -f option",f):(t.pause(),function(n,t){const o={cmd:n,challenge_slug:c.slug,version:c.version,img:c.img||"cmd"};e.ajax({type:"GET",url:d,async:!0,data:o,success:function(e){"function"==typeof t&&t(e)},error:function(e){if("function"==typeof t){const n=e.responseText||"Unknown Error :(";t({output:n,correct:!1,return_code:"‚ò†Ô∏è"})}}})}(n,G))):t.clear()}),{greetings:"",name:"cmdchallenge",height:40,outputLimit:1,convertLinks:!0,linksNoReferrer:!0,onBeforeCommand:function(n){e(".terminal").hide(),e("#term-spinner").show()},onAfterCommand:function(n){e("#term-spinner").hide(),e(".terminal").show()},prompt:function(e){e("("+s+")> ")},completion:function(e,n){return Array.prototype.concat(p,c.completions||[])},doubleTab:function(n,t,o){e("#completions").html(t.join("<span style='color: grey;'> | </span>")).show().fadeOut(5e3)},onClear:T}),n=e.terminal.active(),function(e){const n={};j.forEach((function(e){const t=e.slug;n["/"+t]=function(){c=e,A(),P(),I()}})),n["*"]=function(){c=L()[0]||j[0],A(),P(),I()},routie(n)}()},e.ajax({dataType:"json",url:"/challenges/challenges.json",success:function(e){switch(u){case l:H(e.filter((e=>(e.tags||[]).includes("oops"))));break;case g:H(e.filter((e=>(e.tags||[]).includes("12days"))));break;case i:H(e.filter((e=>!e.tags)))}},error:function(){s="‚ò†Ô∏è",B("Unable to retrieve challenges :(",b)}})}))})();