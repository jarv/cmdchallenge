#!/usr/bin/env python

import yaml
from os import mkdir
from os.path import join, exists, dirname, realpath

dir_path = dirname(realpath(__file__))
dir_cmdchallenge = join(dir_path, "../cmdchallenge")
files_path = join(dir_cmdchallenge, "var", "challenges")

challenges = yaml.safe_load(open(join(dir_path, "..", "challenges.yaml")).read())

for challenge in challenges:
    slug = challenge["slug"]
    desc = challenge["description"]
    dest = join(files_path, slug)
    if not exists(dest):
        mkdir(dest)
    with open(join(dest, "README"), "w") as f:
        if "disp_title" in challenge:
            f.write(f'# {challenge["disp_title"]}\n')
        else:
            f.write(
                "# {}\n".format(
                    " ".join(
                        [
                            word[0].upper() + word[1:]
                            for word in challenge["slug"].split("_")
                        ]
                    )
                )
            )
        f.write("# " + "*" * len(challenge["slug"]) + "\n\n")
        for line in desc.split("\n"):
            f.write("# {}\n".format(line))
